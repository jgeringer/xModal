(function(a){a.fn.xModal=function(m){var k=a('<div class="modal-wrapper"><div><div></div></div></div>'),b=k,c=k.find(">*"),j=k.find(">*>*");var g=a.extend({width:"75%",headline:"",description:"",href:"",effect:"puff",html:""},m);function h(){var n=function(o){if(o){console.log("event:",o)}else{console.log("this didn't come from an event!")}a(k).removeClass(g.effect+"In").addClass(g.effect+"Out");setTimeout(function(){a(k).removeClass("active").removeClass(g.effect+"Out");j.empty();a(k).remove()},1000);a(document).off("keyup.xModalEscape")};a(document).on("keyup.xModalEscape",function(o){console.log("e.which:",o.which);if(o.which=="27"){console.log("you hit escape");n(o)}});a(document).off("click.xModalClose",".closeModal").on("click.xModalClose",".closeModal",function(){console.log("you clicked the close icon");n()})}function l(n,o){a.ajax({url:n,success:function(p){console.log("success");o(p)},error:function(p){console.log("error");o(a("<div>ERROR</div>"))}})}if(!this.selector){console.log("this is not a selector.");var f=a("<div/>");if(g.href){console.log("you gotta path!",g.href);l(g.href,function(n){a(n).prependTo(j)})}if(g.headline){a("<h1>"+g.headline+"</h1>").appendTo(f)}if(g.description){a("<p>"+g.description+"</p>").appendTo(f)}if(g.html){a(g.html).appendTo(f);e()}if(g.img){function d(p){var n=a.Deferred();var o=new Image();o.onload=function(){n.resolve()};o.src=p;return n.promise()}var i=[];i.push(d(g.img));a.when.apply(null,i).done(function(){console.log("doneskies");a("<img src="+g.img+">").appendTo(f);e()})}function e(){f.prependTo(j);k.appendTo("body");var n=j.height();c.find(".closeModal").remove();a('<a class="closeModal icon-close"></a>').prependTo(c);c.width(g.width);c.height(n);c.css({"margin-top":-(n/2)+"px"});a(k).addClass("active").addClass(g.effect+"In");h()}return}this.off("click.xModal").on("click.xModal",function(q){console.log("inside xmodal close");q.preventDefault();var p=a(this),o=p.attr("href");if(!o.indexOf("#")){console.log("contains a #");var r=a(o);r.clone().appendTo(j);if(o.length==1){if(g.headline){a("<h1>"+g.headline+"</h1>").appendTo(j)}if(g.description){a("<p>"+g.description+"</p>").appendTo(j)}}}else{l(o,function(s){a(s).prependTo(j)})}k.appendTo("body");var n=j.height();c.find(".closeModal").remove();a('<a class="closeModal icon-close"></a>').prependTo(c);c.width(g.width);c.height(n);c.css({"margin-top":-(n/2)+"px"});a(k).addClass("active").addClass(g.effect+"In");h()});return this}}(jQuery));